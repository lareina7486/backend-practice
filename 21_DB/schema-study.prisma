generator client {
    provider = "prisma-client"
    output   = "../generated/prisma"
}

datasource db {
    provider = "postgresql"
}

// 배경 이미지 옵션
enum BackgroundType {
    green
    yellow
    blue
    pink
    alvaro
    mikey
    andrew
    chris
}

model Study {
    id           String         @id @default(ulid())
    nickname     String // nickname, title 둘다 같은 경우?
    title        String
    introduction String
    background   BackgroundType // 이미지 URL 주소 저장

    /// @writeOnly
    /// 해시된 비밀번호이며, 응답 시 보안을 위해 제외
    password String

    totalPoint Int      @default(0)
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    habits Habit[]
    emojis Emoji[]
}

model Habit {
    id   String @id @default(ulid())
    name String

    studyId String
    study   Study  @relation(fields: [studyId], references: [id], onDelete: Cascade)

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    records HabitRecord[]
}

model HabitRecord {
    id String @id @default(ulid())

    habitId String
    habit   Habit  @relation(fields: [habitId], references: [id], onDelete: Cascade)

    isDone Boolean @default(true)

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?
}

model Emoji {
    id   String @id @default(ulid())
    type String

    studyId String
    study   Study  @relation(fields: [studyId], references: [id], onDelete: Cascade)
}
